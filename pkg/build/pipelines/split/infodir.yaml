name: Split GNU info pages

needs:
  packages:
    - busybox

inputs:
  packagedir:
    description: |
      The package directory to split info pages from
    default: ${{targets.destdir}}

pipeline:
  - if: ${{inputs.packagedir}} != ${{targets.contextdir}}
    runs: |
      if [ -d "${{inputs.packagedir}}/usr/share/info" ]; then
        rm -f "${{inputs.packagedir}}"/usr/share/info/dir

        mkdir -p "${{targets.contextdir}}/usr/share"
        mv "${{inputs.packagedir}}"/usr/share/info "${{targets.contextdir}}/usr/share"
      fi
